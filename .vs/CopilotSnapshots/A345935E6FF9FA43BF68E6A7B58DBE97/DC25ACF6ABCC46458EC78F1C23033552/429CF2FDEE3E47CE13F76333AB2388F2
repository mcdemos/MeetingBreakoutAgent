using System.Threading;
using System.Threading.Tasks;
using Microsoft.Agents.Builder;
using Microsoft.Agents.Extensions.Teams.Compat;
using Microsoft.Agents.Extensions.Teams.Models;

namespace MeetingBreakout.WebApp.Services;

public class TeamsService : ITeamsService
{
    public Task<TeamsMeetingParticipant> GetMeetingParticipantAsync(ITurnContext turnContext, string? meetingId = null, string? participantId = null, string? tenantId = null, CancellationToken cancellationToken = default)
    {
        return TeamsInfo.GetMeetingParticipantAsync(turnContext, meetingId, participantId, tenantId, cancellationToken);
    }

    public Task<TeamsChannelAccount> GetMemberAsync(ITurnContext turnContext, string userId, CancellationToken cancellationToken = default)
    {
        return TeamsInfo.GetMemberAsync(turnContext, userId, cancellationToken);
    }

    public Task<TeamsPagedMembersResult> GetPagedMembersAsync(ITurnContext turnContext, int? pageSize = null, string? continuationToken = null, CancellationToken cancellationToken = default)
    {
        return TeamsInfo.GetPagedMembersAsync(turnContext, pageSize, continuationToken, cancellationToken);
    }
}
