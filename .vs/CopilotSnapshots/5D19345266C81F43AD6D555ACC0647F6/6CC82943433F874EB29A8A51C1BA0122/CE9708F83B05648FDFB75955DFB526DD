# Deployment Instructions

## 1. Create Azure AD App Registration (CLI)

Use the following Azure CLI commands to create the App Registration required for the Bot Agent and SharePoint access.

```bash
# Variables
APP_NAME="MeetingBreakoutAgent"
# Create App Registration
APP_ID=$(az ad app create --display-name $APP_NAME --query appId -o tsv)

# Create Client Secret
CLIENT_SECRET=$(az ad app credential reset --id $APP_ID --query password -o tsv)

# Get Tenant ID
TENANT_ID=$(az account show --query tenantId -o tsv)

echo "App ID: $APP_ID"
echo "Tenant ID: $TENANT_ID"
echo "Client Secret: $CLIENT_SECRET"
```

## 2. Configure API Permissions

The app needs permission to read/write to SharePoint Lists (`Sites.ReadWrite.All`) and read user profiles (`User.Read.All`).

```bash
# Add API Permissions (Microsoft Graph)
# Graph API UUID: 00000003-0000-0000-c000-000000000000
# Sites.ReadWrite.All (Application) Role ID: 62a82d76-70ea-41e2-9197-370581804d09 (Example ID, check Graph documentation for exact UUIDs)

# Usually it's easier to do this in Portal, but via CLI:
# RequiredResourceAccess manifest manipulation is complex via CLI.
# Recommended: Go to Azure Portal -> App Registrations -> $APP_NAME -> API Permissions
# Add Permission -> Microsoft Graph -> Application Permissions -> Sites.ReadWrite.All
# Add Permission -> Microsoft Graph -> Delegated Permissions -> User.Read (default) or User.Read.All
# Request Admin Consent for the tenant.
```

## 3. Deploy Infrastructure (Bicep)

Deploy the Azure resources (Web App, App Service Plan, Storage).

```bash
RESOURCE_GROUP="MeetingBreakout-RG"
LOCATION="eastus"

# Create Resource Group
az group create --name $RESOURCE_GROUP --location $LOCATION

# Deploy Bicep Template
az deployment group create \
  --resource-group $RESOURCE_GROUP \
  --template-file infra/main.bicep \
  --parameters appName="meeting-breakout-$RANDOM"
```

## 4. Configure App Settings

After deployment, update the App Settings with the actual IDs.

```bash
WEB_APP_NAME=$(az deployment group show --resource-group $RESOURCE_GROUP --name main --query properties.outputs.webAppName.value -o tsv)

# Update App Settings
az webapp config appsettings set --name $WEB_APP_NAME --resource-group $RESOURCE_GROUP --settings \
  AzureAd__TenantId=$TENANT_ID \
  AzureAd__ClientId=$APP_ID \
  AzureAd__ClientSecret=$CLIENT_SECRET \
  SharePoint__SiteId="<Your-Site-ID>" \
  SharePoint__ListId="<Your-List-ID>"
```
